---
layout: default
title: Home
---

<div class="fullscreen-header">
    <header class="fullscreen-header">
        <h1 class="header-title">{{ site.title | default: site.github.repository_name }}</h1>
    </header>

    <p><img class="header-image" src="{{ '/assets/img/cool_cell.jpg' | relative_url }}" alt="cool cell"></p>
</div>

<section id="introduction" class="introduction-section">
    <img class="intro-paper-snippet" src="{{ '/assets/img/paper_snippet.png' | relative_url }}" alt="paper snippet">
    <h2>Introduction</h2>
    <p>Understanding why COVID-19 affects patients so differently, and the immunological differences explaining it,
        is crucial for developing effective, personalized treatments.
        To investigate these differences, we analyze a comprehensive single-cell multi-omics dataset profiling more
        than 780,000 immune cells from 130 patients spanning the full spectrum of COVID-19 severity. From this dataset
        we analyze how immune cell populations vary, along with their gene expression levels,
        and how these changes relate to the progression and intensity of the infection.
        Our final goal is to create a predictive model that can use a patient's immune profile, combined with their
        intrinsic data (age, sex, lifestyle factors), to predict an individual’s vulnerability to severe
        COVID-19 and tailor their treatment.</p>
    <p>This website walks you through our data analysis, from cleaning and
        visualizing the data, to identifying and scoring mechanisms linked with disease severity, to finally training
        a predictive model with what we found.</p>


    <section id="research_questions" class="research-section">
        <h2>Research questions</h2>
        <div class="research-questions-container">
            <div class="research-question left">
                <span class="question-number">1.</span>
                <p>Can we identify and score key genes and cells participating in the immune response to COVID-19?</p>
            </div>
            <div class="research-question right">
                <span class="question-number">2.</span>
                <p>Can we reconstruct the timeline and trajectory of a patient’s COVID-19 infection?</p>
            </div>
            <div class="research-question left">
                <span class="question-number">3.</span>
                <p>Can a patient’s immune profile combined with their intrinsic characteristics (sex, age, smoking habits, ...) be used to predict the severity of their infection?</p>
            </div>
        </div>
    </section>


    <section id="data_exploration" class="data-section">
        <h2>Data Exploration</h2>

        <p>Before conducting an in-depth analysis, it is essential to first understand the patient population
            represented in our dataset. To get a broad view of the cohort, we begin by exploring the patients’ key
            clinical metadata such as age, sex, and sample collection site as seen in this first figure. This initial
            overview provides important insight into how patients are distributed across these variables. For example,
            while male and female patients are nearly equally represented, the distributions of age, smoking status,
            and sample collection site are clearly imbalanced. Notably, a large proportion of the samples come from older,
            non-smoking adults collected at the Ncl collection site.
        </p>

        <div class="pop-cohort-chart-container">
            <div class="flourish-embed flourish-survey pop-cohort-chart" data-src="visualisation/26917202"><script src="https://public.flourish.studio/resources/embed.js"></script><noscript><img src="https://public.flourish.studio/visualisation/26917202/thumbnail" width="100%" alt="survey visualization" /></noscript></div>
        </div>

        <div class="figure-title">
            <h3>Fig. 1</h3>
            <p>Demographics of our dataset.</p>
        </div>


        <div class="data-column">
            <p>Before conducting an in-depth analysis, it is essential to first understand the patient population
                represented in our dataset. To get a broad view of the cohort, we begin by exploring the patients’ key
                clinical metadata such as age, sex, and sample collection site as seen in this first figure. This initial
                overview provides important insight into how patients are distributed across these variables. For example,
                while male and female patients are nearly equally represented, the distributions of age, smoking status,
                and sample collection site are clearly imbalanced. Notably, a large proportion of the samples come from older,
                non-smoking adults collected at the Ncl collection site.</p>


            <div class="donut-chart-container">
                <div class="flourish-embed flourish-chart donut" data-src="visualisation/26916355"><script src="https://public.flourish.studio/resources/embed.js"></script><noscript><img src="https://public.flourish.studio/visualisation/26916355/thumbnail" width="100%" alt="chart visualization" /></noscript></div>

                <div class="figure-title">
                    <h3>Fig. 2</h3>
                    <p style="width:500px">Distribution of worst case severities.</p>
                </div>
            </div>

        </div>

        <div class="data-column">

            <div class="data-exploration-image">
                <div id="onset">
                    <!-- Controls -->
                    <div id="controls" class="#controls">
                        <label for="severitySelect" class="label">Severity:</label>
                        <select id="severitySelect" class="select"></select>
                    </div>

                    <!-- Optional legend (JS expects it) -->
                    <div id="legend" class="#legend"></div>

                    <!-- Chart container (REQUIRED) -->
                    <div id="chart" class="#chart"></div>

                    <!-- Tooltip -->
                    <div id="tooltip" class="tooltip"></div>

                    <div class="figure-title">
                        <h3>Fig. 3</h3>
                        <p>Distribution of patients in days from onset, across severities.</p>
                    </div>

                </div>
            </div>

            <p>In the rest of our analysis, two variables from our dataset will be especially useful for answering our
                research questions: disease severity and days from onset (the number of days since symptoms began). By
                visualizing these features individually and together as well as relating them to patient characteristics,
                we can already get an initial qualitative sense of the dataset’s structure, dynamics and limitations.
                These next two figures reveal two clear imbalances in the data. First, most samples were collected within
                the first two weeks of illness. Second, a large fraction of patients belongs to the Mild and Moderate
                severity groups. This leads to uneven representation across severity levels and uneven sampling across
                the infection timeline. Both can bias downstream analyses, making some comparisons less reliable simply
                because certain groups are under-sampled.
                To address this, we group patients into broader severity categories and time “bins”. This reduces sparsity
                and gives us a more consistent structure for exploring how immune responses evolve. This figure illustrates
                the resulting dataset layout, showing how samples are distributed across the severity groups and across our
                chosen symptom-onset time bins. Some imbalances remain and one case stands out in particular: in the Moderate
                group, there is only a single sample in the 22+ days bin. We flag this early because a lone data point like
                this one can disproportionally influence trends later on, especially when we compare gene expressions over
                time.</p>
        </div>
    </section>
</section>

<section id="diff_ana" class="page-section">
    <h2>Differential Analysis</h2>

    <p>Now that we have a clearer picture of the cohort, we can start looking at what the data is really about: how
        immune cells change their gene expression during COVID-19, and whether these changes differ by severity. To do
        so, we first focus on a small set of single genes well known to play key roles in antiviral signalling and
        interferon responses such as ISG15, IFITM3, MX1, and OAS1. These are not meant to capture the full complexity
        of the immune response, but they offer a simple and interpretable entry point into the dataset.</p>

<section id="single_marker_analysis" class="model-perf-section">
    <h2>Single Marker Analysis</h2>

    <p>To get a first overview of where these signals are coming from, we summarise the average expression of these
        marker genes across broad immune families and three grouped severity levels (heatmaps below). Each panel
        corresponds to a severity group, with rows representing immune cell families and columns representing genes.
        This makes it easy to instantly spot two things: which cell families express these interferon-stimulated genes
        the most, and how that pattern shifts with severity. For example, the strongest expression is concentrated in
        specific immune families (especially innate populations like monocytes and dendritic cells) while other families
        remain comparatively low. At the same time, the intensity and distribution of expression change across severity
        groups, suggesting that severity-linked responses are cell-type dependent, not uniform across the immune system.
        This motivates the next step: moving beyond a static view and examining how these patterns evolve over the course
        of infection.
    </p>
    <div class="triple-pies">
        <div class="flourish-embed flourish-heatmap" data-src="visualisation/26916985"><script src="https://public.flourish.studio/resources/embed.js"></script><noscript><img src="https://public.flourish.studio/visualisation/26916985/thumbnail" width="100%" alt="heatmap visualization" /></noscript></div>
        <div class="flourish-embed flourish-heatmap" data-src="visualisation/26917168"><script src="https://public.flourish.studio/resources/embed.js"></script><noscript><img src="https://public.flourish.studio/visualisation/26917168/thumbnail" width="100%" alt="heatmap visualization" /></noscript></div>
        <div class="flourish-embed flourish-heatmap" data-src="visualisation/26917249"><script src="https://public.flourish.studio/resources/embed.js"></script><noscript><img src="https://public.flourish.studio/visualisation/26917249/thumbnail" width="100%" alt="heatmap visualization" /></noscript></div>
    </div>

    <div class="figure-title" style="width:100%; justify-content: center">
        <h3>Fig. 4</h3>
        <p>ISG expression across immune families and severity groups.</p>
    </div>

    <div class="data-column">
        <div class="data-double-image">
            <div id="markers">
                <!-- Controls -->
                <div class="controls">
                    <div class="checkbox-row">
                        <label for="geneDropdown">Gene:</label>
                        <select id="geneDropdown" class="select"></select>
                    </div>

                    <div class="checkbox-row">
                        <label for="showOutlierToggle">Show Outlier:</label>
                        <input type="checkbox" id="showOutlierToggle">
                    </div>
                </div>

                <div class="radio-buttons">

                    <label>Display Mode:</label>
                    <div class="radio-choices-tight">
                        <div class="radio-row">
                            <input type="radio" name="lineMode" value="mean" checked>
                            <label>Mean</label>
                        </div>
                        <div class="radio-row">
                            <input type="radio" name="lineMode" value="regression">
                            <label>Regression</label>
                        </div>
                        <div class="radio-row">
                            <input type="radio" name="lineMode" value="both">
                            <label>Both</label>
                        </div>
                    </div>
                </div>

                <!-- Visualization container -->
                <div id="vis"></div>

                <div class="figure-title" style="width:500px; justify-content: start">
                    <h3>Fig. 5</h3>
                    <p>Temporal trajectories of interferon-stimulated genes, toggle for outlier.</p>
                </div>
            </div>
        </div>

        <p>Next, we move from this static overview to a temporal perspective by plotting these same markers across our
            predefined time bins. Even in this simple marker-based view, we can already see distinct temporal patterns
            that differ across severity groups, suggesting that the immune response is not only severity-dependent but
            also dynamic over the course of infection. This is encouraging for our later goal of reconstructing infection
            trajectories.

            At the same time, this is where an important limitation becomes visible. Our dataset is not truly longitudinal
            as we do not follow the same individuals at regular intervals. Therefore, any “trajectory” we infer is
            reconstructed by aligning different patients along a shared timeline. That approach becomes fragile when the
            data is sparse in certain regions of the timeline. In particular, as we flagged earlier, the Moderate 22+ days
            bin contains only a single sample, which can disproportionately influence trends. Figure 3 makes this explicit:
            the interactive toggle lets you include or exclude this outlier, and the resulting change in the trajectory
            highlights how sensitive some conclusions can be to rare samples.

            Despite this limitation, reconstructing meaningful trajectories can still be informative, especially in the
            early phases of infection, where much of the dataset is concentrated and trends are more stable. In the rest
            of the project, we keep these sampling constraints in mind and rely on aggregated, score-based analyses to
            reduce sensitivity to single observations.</p>

    </div>
</section>

<section id="linear_regression" class="feature-imp-section">
    <h2>Linear Regression</h2>
    <p>
        By examining the dataset, we noticed it contained negative values, which confirmed the data had been scaled.
        Because differential expression analysis requires untransformed UMI counts,
        these processed values are not appropriate. However, as seen in figure 4 (data from cd4.prolif of a few patients),
        the raw data still needs to be transformed. We chose a log1p transform which can be displayed using the toggle.
        This helps to stabilize variance and make the data more interpretable for differential expression analysis.
        We use differential analysis to identify the genes whose expression increases or decreases with disease severity.
        Our approach is to use a linear regression model for each gene’s expression across cells and patients.
        We chose to do a pseudo-bulk analysis, aggregating gene expression at the patient level by summing counts across cells within specific immune cell families.
        By reducing the data to a patient-level summary, we can perform the analysis more efficiently,
        while still capturing the key variability in gene expression related to disease severity. The results are displayed in the packed circles graph,
         with size being defined by the metric returned by the differential expression analysis.
    </p>
    
    <div class="data-exploration-image">
        <div id="raw-log-chart"></div>
        <div class="figure-title">
            <h3>Fig. 6</h3>
            <p>Distribution of scaled and raw UMI counts.</p>
        </div>
    </div>

    <div class="packed-circles">
        <div class="flourish-embed flourish-hierarchy packed-circles" data-src="visualisation/26892943"><script src="https://public.flourish.studio/resources/embed.js"></script><noscript><img src="https://public.flourish.studio/visualisation/26892943/thumbnail" width="100%" alt="hierarchy visualization" /></noscript></div>
        <div class="figure-title" style="width:800px">
            <h3>Fig. 7</h3>
            <p>Coefficients of the 50 most differentially expressed genes in their respective cells.</p>
        </div>
    </div>
</section>

</section>

<section id="temp_ana" class="page-section">
    <h2>Temporal Analysis</h2>
    <p>Lorem ipsum dolor sit amet consectetur adipiscing elit. Quisque faucibus ex sapien vitae pellentesque sem placerat. In id cursus mi pretium tellus duis convallis. Tempus leo eu aenean sed diam urna tempor. Pulvinar vivamus fringilla lacus nec metus bibendum egestas. Iaculis massa nisl malesuada lacinia integer nunc posuere. Ut hendrerit semper vel class aptent taciti sociosqu. Ad litora torquent per conubia nostra inceptos himenaeos.

        Lorem ipsum dolor sit amet consectetur adipiscing elit. Quisque faucibus ex sapien vitae pellentesque sem placerat. In id cursus mi pretium tellus duis convallis. Tempus leo eu aenean sed diam urna tempor. Pulvinar vivamus fringilla lacus nec metus bibendum egestas. Iaculis massa nisl malesuada lacinia integer nunc posuere. Ut hendrerit semper vel class aptent taciti sociosqu. Ad litora torquent per conubia nostra inceptos himenaeos.

        Lorem ipsum dolor sit amet consectetur adipiscing elit. Quisque faucibus ex sapien vitae pellentesque sem placerat. In id cursus mi pretium tellus duis convallis. Tempus leo eu aenean sed diam urna tempor. Pulvinar vivamus fringilla lacus nec metus bibendum egestas. Iaculis massa nisl malesuada lacinia integer nunc posuere. Ut hendrerit semper vel class aptent taciti sociosqu. Ad litora torquent per conubia nostra inceptos himenaeos.

    </p>

    <div class="imm-traj-container">
        <div class="controls">
            <label for="imm-traj-dropdown">Cell Type:</label>
            <select id="imm-traj-dropdown"></select>
        </div>
        <div id="imm-traj-vis"></div>
        <div class="figure-title">
            <h3>Fig. 8</h3>
            <p>Cell-type scores across time bins and severity groups.</p>
        </div>
    </div>
</section>

<section id="pred_mod" class="page-section">
    <h2>Predictive Model</h2>
    <p>To predict how severe a patient’s COVID-19 infection will become, we developed a model that combines clinical
        information with immune system signals. The clinical information includes factors such as age, sex, smoking
        status, and time since symptom onset. The immune profile is summarized by the cell-level scores computed earlier,
        which capture immune activation based on the expression of key genes associated with COVID-19 severity. By
        bringing these two sources of information together, <span>the model aims to anticipate the overall trajectory of the
        disease for each patient.</span>
    </p>

    <section id="model_performance" class="model-perf-section">
    <h2>Model performance</h2>
    <p>We approached this prediction task in two complementary ways. First, we used the dataset’s original severity
        labels and continuous days-from-onset measurements, reflecting how disease progression is recorded in real-world
        clinical settings. We then repeated the analysis using the grouped severity categories and discretized time bins
        introduced in our Data Exploration. This second approach allowed us to assess whether a simpler, biologically
        motivated representation of the data leads to better interpretability and stronger predictions. <br/>
        Across both settings, <span>we compared different machine-learning models</span> to evaluate how accurately they could
        predict disease severity. Figure 5 below summarizes model performance using accuracy and F1-score.
        Overall, the grouped-severity and time-binned representation leads to a clear improvement for both models,
        with especially strong gains for XGBoost. This suggests that organizing clinical outcomes into biologically
        coherent categories and disease stages reduces noise and ambiguity in the labels, making severity easier to
        predict. Under this formulation, XGBoost performs best overall, indicating that meaningful predictions of
        COVID-19 severity can be made using this model.
    </p>
    <div class="side-by-side-figures">
        <div class="flourish-embed flourish-slope figure-flourish" data-src="visualisation/26885244"><script src="https://public.flourish.studio/resources/embed.js"></script><noscript><img src="https://public.flourish.studio/visualisation/26885244/thumbnail" width="100%" alt="slope visualization" /></noscript></div>
        <div class="flourish-embed flourish-slope figure-flourish" data-src="visualisation/26885113"><script src="https://public.flourish.studio/resources/embed.js"></script><noscript><img src="https://public.flourish.studio/visualisation/26885113/thumbnail" width="100%" alt="slope visualization" /></noscript></div>
    </div>

        <div class="figure-title" style="width: 800px">
            <h3>Fig. 9</h3>
            <p>Difference in performance of XGBoost and Random forest using grouped or ungrouped severities and time bins,
                measured in Accuracy vs Macro-F1</p>
        </div>

    </section>

    <section id="feature_importance" class="feature-imp-section">
    <h2>Feature importance</h2>
    <p>Beyond asking how well our models predict COVID-19 severity, we wanted to understand what specific features drive
        these predictions. <span>To do this, we examined feature importance patterns from our models, which highlight the
        immune cells that most strongly influence the predictions.</span> To properly analyze feature importance, we looked at it through two axes. First, we visualized how our two algorithms
        prioritize immune signals, and what differences there are between them.
        Our second axis aimed to compare the feature rankings obtained when using the dataset's original labels against those found using
        our grouped severities and time representations. This allowed us to see how simplifying the clinical labels affects
        which features emerge as important. <br/>
        Features that remain influential across both models likely represent robust biological signals linked to COVID-19 severity,
        and could be prioritized for further study.
    </p>
    <p>
        Starting with the ungrouped severity and time labels, we found that both models highlighted biologically
        meaningful immune pathways linked to COVID-19 severity, although they disagreed on the ordering of these features.
        The Random Forest model (on the right below) spread importance across
        multiple related immune cell types, namely CD4 and CD8 T cells, dendritic cells and monocytes, suggesting
        that severity is associated with coordinated changes across several immune
        compartments rather than a single dominant signal.
        In contrast, XGBoost (on the left below) focused on a smaller set of highly informative features within these same immune families.
        Myeloid cells and CD4 T cells emerged as especially influential, reflecting more targeted immune signatures that
        best distinguish severe from mild disease.
        Across both models, platelet-related and progenitor cell signals (not shown) played only a minor role, suggesting limited
        relevance for severity prediction in this setting. These observations are summarized in Figure 6 below.
    </p>

        <div class="side-by-side-figures">
            <div class="flourish-embed flourish-sankey sankey-diagram" data-src="visualisation/26906116"><script src="https://public.flourish.studio/resources/embed.js"></script><noscript><img src="https://public.flourish.studio/visualisation/26906116/thumbnail" width="100%" alt="sankey visualization" /></noscript></div>
            <div class="flourish-embed flourish-sankey sankey-diagram" data-src="visualisation/26904223"><script src="https://public.flourish.studio/resources/embed.js"></script><noscript><img src="https://public.flourish.studio/visualisation/26904223/thumbnail" width="100%" alt="sankey visualization" /></noscript></div>
        </div>

        <div class="figure-title">
            <h3>Fig. 10</h3>
            <p>Feature importance of immune cells according to RF and XGB models, using original labels.</p>
        </div>


        <p>
            We then shifted to grouped severity categories and time bins, under which the immune features
            driving predictions became clearer and more consistent across models. In this setting, both models
            agreed that myeloid cells, especially dendritic cells and monocytes, were
            central to disease severity. This highlights the key role of innate immune dysregulation and antigen
            presentation in shaping overall COVID-19 outcomes.
            The adaptive immune system also remained prominent, as CD4 T cells ranked among the most
            important contributors, followed by B and plasma cells, showing the importance of adaptive
            immune responses in severe disease.
            Compared to the ungrouped analysis, importance was no longer spread across many isolated cell subtypes but rather
            at the level of broader cell families. This suggests that the grouped
            representation captures the bigger picture and identifies the core immune mechanisms underlying disease progresion.
            While the two models
            still differed slightly in how they distributed importance, they now agreed on the same overall hierarchy of
            immune families. This is shown in Figure 7.
        </p>

        <div class="side-by-side-figures">
            <div class="flourish-embed flourish-sankey sankey-diagram" data-src="visualisation/26915340"><script src="https://public.flourish.studio/resources/embed.js"></script><noscript><img src="https://public.flourish.studio/visualisation/26915340/thumbnail" width="100%" alt="sankey visualization" /></noscript></div>
            <div class="flourish-embed flourish-sankey sankey-diagram" data-src="visualisation/26915544"><script src="https://public.flourish.studio/resources/embed.js"></script><noscript><img src="https://public.flourish.studio/visualisation/26915544/thumbnail" width="100%" alt="sankey visualization" /></noscript></div>
        </div>

        <div class="figure-title">
            <h3>Fig. 11</h3>
            <p>Feature importance of immune cells according to RF and XGB models, using grouped labels.</p>
        </div>
    </section>


</section>

<div id="sidebar-question" class="sidebar-question">
    <h2 id="sidebar-question-title"></h2>
    <p id="sidebar-question-text"></p>
</div>

<footer class="site-footer">
    <div class="footer-content">
        <div class="footer-names">
            <span>Matis Ribadeau</span>
            <span>Teo Wermeille</span>
            <span>Toni Nigro</span>
            <span>Nestor Melissargos</span>
            <span>Matteo Jourdan</span>
        </div>
        <a href="https://github.com/matteojourdan/data-story-new" class="github-link" target="_blank" rel="noopener">
            <svg height="24" width="24" viewBox="0 0 16 16" fill="currentColor">
                <path d="M8 0C3.58 0 0 3.58 0 8c0 3.54 2.29 6.53 5.47 7.59.4.07.55-.17.55-.38 0-.19-.01-.82-.01-1.49-2.01.37-2.53-.49-2.69-.94-.09-.23-.48-.94-.82-1.13-.28-.15-.68-.52-.01-.53.63-.01 1.08.58 1.23.82.72 1.21 1.87.87 2.33.66.07-.52.28-.87.51-1.07-1.78-.2-3.64-.89-3.64-3.95 0-.87.31-1.59.82-2.15-.08-.2-.36-1.02.08-2.12 0 0 .67-.21 2.2.82.64-.18 1.32-.27 2-.27.68 0 1.36.09 2 .27 1.53-1.04 2.2-.82 2.2-.82.44 1.1.16 1.92.08 2.12.51.56.82 1.27.82 2.15 0 3.07-1.87 3.75-3.65 3.95.29.25.54.73.54 1.48 0 1.07-.01 1.93-.01 2.2 0 .21.15.46.55.38A8.013 8.013 0 0016 8c0-4.42-3.58-8-8-8z"/>
            </svg>
            View on GitHub
        </a>
    </div>
</footer>


<script src="{{ '/assets/js/scroll-animations.js' | relative_url }}"></script>
<script src="{{ '/assets/js/active_nav.js' | relative_url }}"></script>

<!-- D3 -->
<script src="{{ 'https://d3js.org/d3.v7.min.js'}}"></script>

<!-- Vega-Lite for markers visualization -->
<script src="{{ 'https://cdn.jsdelivr.net/npm/vega@5'}}"></script>
<script src="{{ 'https://cdn.jsdelivr.net/npm/vega-lite@5' }}"></script>
<script src="{{ 'https://cdn.jsdelivr.net/npm/vega-embed@6' }}"></script>

<!-- Your radar plot logic -->
<script src="{{ '/assets/js/onset_hist.js' | relative_url }}"></script>

<!-- Markers visualization -->
<link rel="stylesheet" href="{{ '/assets/css/markers.css' | relative_url }}">
<script src="{{ '/assets/js/markers.js' | relative_url }}"></script>

<!-- Raw/Log histogram -->
<link rel="stylesheet" href="{{ '/assets/css/raw_log.css' | relative_url }}">
<script src="{{ '/assets/js/raw_log.js' | relative_url }}"></script>

<!-- Immune trajectory visualization -->
<link rel="stylesheet" href="{{ '/assets/css/imm_traj.css' | relative_url }}">
<script src="{{ '/assets/js/imm_traj.js' | relative_url }}"></script>
