---
layout: default
title: Home
---

<div class="fullscreen-header">
    <header class="fullscreen-header">
        <h1 class="header-title">{{ site.title | default: site.github.repository_name }}</h1>
    </header>

    <p><img class="header-image" src="{{ '/assets/img/cool_cell.jpg' | relative_url }}" alt="cool cell"></p>
</div>

<section id="introduction" class="introduction-section">
    <img class="intro-paper-snippet" src="{{ '/assets/img/paper_snippet.png' | relative_url }}" alt="paper snippet">

    <div class="intro-text">
        <h2>Introduction</h2>
        <p>Understanding why COVID-19 affects patients so differently, and the immunological differences explaining it,
            is crucial for developing effective, personalized treatments.
            To investigate these differences, we analyze a comprehensive single-cell multi-omics dataset profiling more
            than 780,000 immune cells from 130 patients spanning the full spectrum of COVID-19 severity. From this dataset
            we analyze how immune cell populations vary, along with their gene expression levels,
            and how these changes relate to the progression and intensity of the infection.
            Our final goal is to create a predictive model that can use a patient's immune profile, combined with their
            intrinsic data (age, sex, lifestyle factors), to predict an individual’s vulnerability to severe
            COVID-19 and tailor their treatment.</p>
        <p>This website walks you through our data analysis, from cleaning and
            visualizing the data, to identifying and scoring mechanisms linked with disease severity, to finally training
            a predictive model with what we found.</p>
    </div>


    <section id="research_questions" class="research-section">
        <h2>Research questions</h2>
        <div class="research-questions-container">
            <div class="research-question left">
                <span class="question-number">1.</span>
                <p>Can we identify and score key genes and cells participating in the immune response to COVID-19?</p>
            </div>
            <div class="research-question right">
                <span class="question-number">2.</span>
                <p>Are immune responses temporally structured, and do different severity groups follow distinct temporal trajectories characterized by differences in the amplitude, timing, or variability of immune activity?</p>
            </div>
            <div class="research-question left">
                <span class="question-number">3.</span>
                <p>Can a patient’s immune profile be used to predict the severity of their infection, and which features contribute most to this prediction?</p>
            </div>
        </div>
    </section>


    <section id="data_exploration" class="data-section">
        <h2>Data Exploration</h2>

        <p>Before conducting an in-depth analysis, it is essential to first understand the patient population
            represented in our dataset. To get a broad view of the cohort, we begin by <span>exploring the patients’ key
            clinical metadata such as age, sex, and sample collection site</span> as seen in this first figure. This initial
            overview provides important insight into how patients are distributed across these variables. For example,
            while male and female patients are nearly equally represented, the distributions of age, smoking status,
            and sample collection site are clearly imbalanced. Notably, a large proportion of the samples come from older,
            non-smoking adults collected at the Ncl collection site.
        </p>

        <div class="pop-cohort-chart-container">
            <div class="flourish-embed flourish-survey pop-cohort-chart" data-src="visualisation/26917202"><script src="https://public.flourish.studio/resources/embed.js"></script><noscript><img src="https://public.flourish.studio/visualisation/26917202/thumbnail" width="100%" alt="survey visualization" /></noscript></div>
        </div>

        <div class="figure-title">
            <h3>Fig. 1</h3>
            <p>Demographics of our dataset.</p>
        </div>

        <p style="margin: 50px 0 50px 0">In the rest of our analysis, two variables from our dataset will be especially useful for answering our
            research questions: <span>disease severity and days from onset</span> (the number of days since symptoms began). By
            visualizing these features individually and together as well as relating them to patient characteristics,
            we can already get an initial qualitative sense of the dataset’s structure, dynamics and limitations.
            These next two figures reveal two clear imbalances in the data. First, most samples were collected within
            the first two weeks of illness. Second, a large fraction of patients belongs to the Mild and Moderate
            severity groups. This leads to uneven representation across severity levels and uneven sampling across
            the infection timeline. Both can bias downstream analyses, making some comparisons less reliable simply
            because certain groups are under-sampled.</p>

        <div class="side-by-side-figures">
            <div id="onset">
                <!-- Controls -->
                <div id="controls" class="#controls">
                    <label for="severitySelect" class="label">Severity:</label>
                    <select id="severitySelect" class="select"></select>
                </div>

                <!-- Optional legend (JS expects it) -->
                <div id="legend" class="#legend"></div>

                <!-- Chart container (REQUIRED) -->
                <div id="chart" class="#chart"></div>

                <!-- Tooltip -->
                <div id="tooltip" class="tooltip"></div>

                <div class="figure-title" style="margin-top: 12px">
                    <h3>Fig. 2</h3>
                    <p>Distribution of patients in days from onset, across severities.</p>
                </div>

            </div>

            <div class="donut-chart-container">
                <div class="flourish-embed flourish-chart donut" data-src="visualisation/26916355"><script src="https://public.flourish.studio/resources/embed.js"></script><noscript><img src="https://public.flourish.studio/visualisation/26916355/thumbnail" width="100%" alt="chart visualization" /></noscript></div>

                <div class="figure-title">
                    <h3>Fig. 3</h3>
                    <p>Distribution of worst case severities.</p>
                </div>
            </div>

        </div>

        <div class="data-column" style="display: flex; flex-direction:row; margin: 70px 0 0 0">
            <p>To address this, we <span>group patients into broader severity categories and time “bins”.</span>
                This reduces sparsity
                and gives us a more consistent structure for exploring how immune responses evolve. This figure illustrates
                the resulting dataset layout, showing how samples are distributed across the severity groups and across our
                chosen symptom-onset time bins. Some imbalances remain and one case stands out in particular: in the Moderate
                group, there is only a single sample in the 22+ days bin. We flag this early because a lone data point like
                this one can disproportionally influence trends later on, especially when we compare gene expressions over
                time.</p>

            <div>
                <div class="flourish-embed flourish-chart bar-stacked" data-src="visualisation/26920025"><script src="https://public.flourish.studio/resources/embed.js"></script><noscript><img src="https://public.flourish.studio/visualisation/26920025/thumbnail" width="100%" alt="chart visualization" /></noscript></div>
                <div class="figure-title" style="margin-top: 0">
                    <h3>Fig. 4</h3>
                    <p>Distribution of patients across our chosen severity and time labels.</p>
                </div>
            </div>
        </div>


    </section>
</section>

<section id="diff_ana" class="page-section">
    <h2>Differential Analysis</h2>

    <p>Now that we have a clearer picture of the cohort, we can start looking at what the data is really about: <span>how
        immune cells change their gene expression during COVID-19, and whether these changes differ by severity.</span> To do
        so, we first focus on a small set of single genes well known to play key roles in antiviral signalling and
        interferon responses such as ISG15, IFITM3, MX1, and OAS1. These are not meant to capture the full complexity
        of the immune response, but they offer a simple and interpretable entry point into the dataset.</p>

<section id="single_marker_analysis" class="feature-imp-section">
    <h2>Single Marker Analysis</h2>

    <p>To get a first overview of where these signals are coming from, we summarise the average expression of these
        marker genes across broad immune families and three grouped severity levels (heatmaps below). Each panel
        corresponds to a severity group, with rows representing immune cell families and columns representing genes.
        This makes it easy to instantly spot two things: which cell families express these interferon-stimulated genes
        the most, and how that pattern shifts with severity. For example, the strongest expression is concentrated in
        specific immune families (especially innate populations like monocytes and dendritic cells) while other families
        remain comparatively low. At the same time, the intensity and distribution of expression change across severity
        groups, suggesting that severity-linked responses are cell-type dependent, not uniform across the immune system.
        This motivates the next step: moving beyond a static view and examining how these patterns evolve over the course
        of infection.
    </p>
    <div class="triple-pies">
        <div class="flourish-embed flourish-heatmap" data-src="visualisation/26916985"><script src="https://public.flourish.studio/resources/embed.js"></script><noscript><img src="https://public.flourish.studio/visualisation/26916985/thumbnail" width="100%" alt="heatmap visualization" /></noscript></div>
        <div class="flourish-embed flourish-heatmap" data-src="visualisation/26917168"><script src="https://public.flourish.studio/resources/embed.js"></script><noscript><img src="https://public.flourish.studio/visualisation/26917168/thumbnail" width="100%" alt="heatmap visualization" /></noscript></div>
        <div class="flourish-embed flourish-heatmap" data-src="visualisation/26917249"><script src="https://public.flourish.studio/resources/embed.js"></script><noscript><img src="https://public.flourish.studio/visualisation/26917249/thumbnail" width="100%" alt="heatmap visualization" /></noscript></div>
    </div>

    <div class="figure-title" style="width:100%; justify-content: center">
        <h3>Fig. 5</h3>
        <p>ISG expression across immune families and severity groups.</p>
    </div>

    <div class="data-column">
        <div class="data-double-image">
            <div id="markers">
                <!-- Controls -->
                <div class="controls">
                    <div class="checkbox-row">
                        <label for="geneDropdown">Gene:</label>
                        <select id="geneDropdown" class="select"></select>
                    </div>

                    <div class="checkbox-row">
                        <label for="showOutlierToggle">Show Outlier:</label>
                        <input type="checkbox" id="showOutlierToggle">
                    </div>
                </div>

                <div class="radio-buttons">

                    <label>Display Mode:</label>
                    <div class="radio-choices-tight">
                        <div class="radio-row">
                            <input type="radio" name="lineMode" value="mean" checked>
                            <label>Mean</label>
                        </div>
                        <div class="radio-row">
                            <input type="radio" name="lineMode" value="regression">
                            <label>Regression</label>
                        </div>
                        <div class="radio-row">
                            <input type="radio" name="lineMode" value="both">
                            <label>Both</label>
                        </div>
                    </div>
                </div>

                <!-- Visualization container -->
                <div id="vis"></div>

                <div class="figure-title" style="width:500px; justify-content: start">
                    <h3>Fig. 6</h3>
                    <p>Temporal trajectories of interferon-stimulated genes, toggle for outlier.</p>
                </div>
            </div>
        </div>

        <p>Next, we move from this static overview to a temporal perspective by plotting these same markers across our
            predefined time bins. Even in this simple marker-based view, we can already see distinct temporal patterns
            that differ across severity groups, suggesting that the <span>immune response is not only severity-dependent but
            also dynamic over the course of infection.</span> This is encouraging for our later goal of reconstructing infection
            trajectories.

            At the same time, this is where an important limitation becomes visible. Our dataset is not truly longitudinal
            as we do not follow the same individuals at regular intervals. Therefore, any “trajectory” we infer is
            reconstructed by aligning different patients along a shared timeline. That approach becomes fragile when the
            data is sparse in certain regions of the timeline. In particular, as we flagged earlier, the Moderate 22+ days
            bin contains only a single sample, which can disproportionately influence trends. Figure 6 makes this explicit:
            the interactive toggle lets you include or exclude this outlier, and the resulting change in the trajectory
            highlights how sensitive some conclusions can be to rare samples.

            Despite this limitation, reconstructing meaningful trajectories can still be informative, especially in the
            early phases of infection, where much of the dataset is concentrated and trends are more stable. In the rest
            of the project, we keep these sampling constraints in mind and rely on aggregated, score-based analyses to
            reduce sensitivity to single observations.</p>

    </div>
</section>

<section id="linear_regression" class="model-perf-section">
    <h2>Linear Regression</h2>
    <p>
        To move beyond a few handpicked markers and capture the immune response more systematically, we now turn to a
        <span>genome-wide differential analysis</span>. A first look at the expression matrix shows that it contains negative values,
        confirming that the data has already been scaled and transformed. Since differential expression models are
        typically defined on unscaled raw count data, these processed values are not suitable inputs. Figure 7
        illustrates this on a small example (CD4.Prolif cells from a few patients): the raw signal is highly skewed,
        and a simple transformation makes the distribution much more stable. We therefore apply a log1p transform,
        which you can toggle on the figure, to reduce the impact of extreme values and make gene expression more
        comparable across patients.
    </p>
    
    <div class="data-exploration-image">
        <div id="raw-log-chart"></div>
        <div class="figure-title" style="margin-bottom: 20px">
            <h3>Fig. 7</h3>
            <p>Distribution of scaled and raw UMI counts.</p>
        </div>
    </div>

    <p>
        With the data in a more appropriate form, we now aim to identify genes whose expression systematically increases
        or decreases with disease severity. Concretely, we fit a <span>linear regression model for each gene, using severity
        as the main variable of interest and adjusting for any relevant covariates</span>. Figure 8 provides an overview of the
        results. Each circle represents a cell type; within it, we highlight the genes with a significant severity
        association (after FDR correction). The circle size reflects the overall strength of the signal in that cell type,
        based on the summed magnitude of the gene-level metrics. This view helps us quickly identify which immune
        compartments show the clearest severity-linked transcriptional shifts.
    </p>

    <div class="packed-circles">
        <div class="flourish-embed flourish-hierarchy packed-circles" data-src="visualisation/26892943"><script src="https://public.flourish.studio/resources/embed.js"></script><noscript><img src="https://public.flourish.studio/visualisation/26892943/thumbnail" width="100%" alt="hierarchy visualization" /></noscript></div>
        <div class="figure-title" style="width:800px; margin-bottom: 20px">
            <h3>Fig. 8</h3>
            <p>Coefficients of the 50 most differentially expressed genes in their respective cells.</p>
        </div>
    </div>

    <p>
        To move from these gene-level results to something we can compare across patients, we translate the regression
        output into an immune score. The regression provides a cell-type–specific metric for each gene, capturing both
        the direction and the strength of its association with severity in that immune compartment. We then combine these
        metrics with each patient’s pseudo-bulk expression (aggregate expression across all cells of same type): for
        every patient and every cell type, we take the expression level of each gene and multiply it by its corresponding
        metric for that same cell type, so that genes with stronger severity associations contribute more to the score.
        Summing these weighted contributions gives a single score per patient and cell type which gives us a way to
        quantify how strongly linked a cell population is to severity.
    </p>

    <p>
        With these cell-type–specific immune scores in hand, we can now directly answer the first part of our research
        question: <span>we not only identify the genes most associated with COVID-19 severity, but we also condense this
        information into an interpretable patient-level score.</span> However, severity alone does not tell the full story.
        COVID-19 is a dynamic process, and immune activity is expected to rise and fall as the infection evolves. This
        naturally leads to our next question: are these immune responses temporally structured? In the following section,
        we use the same scores to track immune activity across our time bins and compare how trajectories differ between
        severity groups. We focus not only on overall levels, but also on changes in amplitude, timing, and variability
        over the course of infection.
    </p>
</section>

</section>

<section id="temp_ana" class="page-section">
    <h2>Temporal Analysis</h2>
    <p>
        Once we have an immune score for each patient and each cell type, we can ask our next question: do immune
        responses follow a time structure, and do the severities evolve differently? In other words, are the differences
        we saw earlier just “stronger vs weaker” responses, or do they also differ in timing, peaks, and persistence?
    </p>
    <p>
        To explore this, we align samples along a common infection timeline using broad time bins and group patients by
        severity. For each immune cell type, we <span>average the immune scores within each severity group and time bin to
        obtain a trajectory over time.</span> In Figure 9, the x-axis shows the binned timeline and the y-axis the normalized
        immune score; each colored line corresponds to a severity group, with higher values indicating stronger
        severity-linked activity. The dropdown menu lets you switch between immune families (e.g., NK, CD4, CD8) and
        explore their subtypes.
    </p>

    <div class="temp-ana-controls" style="margin-top: 30px">
        <label for="tempAnaSelect">Select Graph:</label>
        <select id="tempAnaSelect">
            <option value="graph1">B and Plasma cells</option>
            <option value="graph2">CD4 T cells</option>
            <option value="graph3">C8 T cells</option>
            <option value="graph4">DC cells</option>
            <option value="graph5">Monocytes</option>
            <option value="graph6">NK cells</option>
            <option value="graph7">Platelets</option>
        </select>
    </div>

    <div class="temp-ana-graphs-wrapper">
        <div id="tempAnaGraph1" class="temp-ana-graph active">
            <div class="flourish-embed flourish-chart graph-temp-ana" data-src="visualisation/26922512"><script src="https://public.flourish.studio/resources/embed.js"></script><noscript><img src="https://public.flourish.studio/visualisation/26922512/thumbnail" width="100%" alt="chart visualization" /></noscript></div>
        </div>
        <div id="tempAnaGraph2" class="temp-ana-graph">
            <div class="flourish-embed flourish-chart graph-temp-ana" data-src="visualisation/26922667"><script src="https://public.flourish.studio/resources/embed.js"></script><noscript><img src="https://public.flourish.studio/visualisation/26922667/thumbnail" width="100%" alt="chart visualization" /></noscript></div>
        </div>
        <div id="tempAnaGraph3" class="temp-ana-graph">
            <div class="flourish-embed flourish-chart" data-src="visualisation/26922898"><script src="https://public.flourish.studio/resources/embed.js"></script><noscript><img src="https://public.flourish.studio/visualisation/26922898/thumbnail" width="100%" alt="chart visualization" /></noscript></div>
        </div>
        <div id="tempAnaGraph4" class="temp-ana-graph">
            <div class="flourish-embed flourish-chart" data-src="visualisation/26922938"><script src="https://public.flourish.studio/resources/embed.js"></script><noscript><img src="https://public.flourish.studio/visualisation/26922938/thumbnail" width="100%" alt="chart visualization" /></noscript></div>
        </div>
        <div id="tempAnaGraph5" class="temp-ana-graph">
            <div class="flourish-embed flourish-chart" data-src="visualisation/26922962"><script src="https://public.flourish.studio/resources/embed.js"></script><noscript><img src="https://public.flourish.studio/visualisation/26922962/thumbnail" width="100%" alt="chart visualization" /></noscript></div>
        </div>
        <div id="tempAnaGraph6" class="temp-ana-graph">
            <div class="flourish-embed flourish-chart" data-src="visualisation/26922989"><script src="https://public.flourish.studio/resources/embed.js"></script><noscript><img src="https://public.flourish.studio/visualisation/26922989/thumbnail" width="100%" alt="chart visualization" /></noscript></div>
        </div>
        <div id="tempAnaGraph7" class="temp-ana-graph">
            <div class="flourish-embed flourish-chart" data-src="visualisation/26923003"><script src="https://public.flourish.studio/resources/embed.js"></script><noscript><img src="https://public.flourish.studio/visualisation/26923003/thumbnail" width="100%" alt="chart visualization" /></noscript></div>
        </div>
    </div>

    <div class="figure-title" style="margin-bottom: 30px">
        <h3>Fig. 9</h3>
        <p>Cell-type immune scores across time bins and severity groups.</p>
    </div>

    <p>
        Across many immune compartments, the trajectories are clearly not flat: <span>immune activity changes over time,
        which suggests the response is temporally structured.</span> Just as importantly, severity groups often follow
        distinct patterns. In several cell types, severe/critical cases show larger deviations early on and, in some
        cases, responses that remain elevated or shift later in the timeline. Mild/asymptomatic cases tend to show
        smaller fluctuations and earlier stabilization. <br/>
        That said, these dynamics are not uniform across the immune system. Some cell types show strong separation
        between severity groups, while others overlap substantially or fluctuate more. This heterogeneity is exactly
        why an interactive view is helpful: instead of listing dozens of similar plots, you can quickly explore where
        the most pronounced differences appear.
    </p>

    <p>
        One important limitation is that this dataset is not fully longitudinal as we are not following the same
        individuals at regular intervals. The “trajectories” we show are reconstructed by aligning different patients
        along a shared timeline. This works best where the data is dense (especially early after symptom onset) and
        becomes less reliable in sparse regions. As noted earlier, for example, the Moderate 22+ days bin contains
        only a single sample, which can disproportionately affect the shape of the curve in that time window.
    </p>

    <p>
        Even with these constraints, the patterns are still informative. The fact that many cell types show consistent
        time structure and severity-dependent differences suggests that temporal immune features carry meaningful signal.
        This naturally sets up the next step of the project: using cell-level immune scores (and potentially their
        time-dependent behavior) as inputs to a predictive model that estimates disease severity from a patient’s immune
        profile.
    </p>


</section>

<section id="pred_mod" class="page-section">
    <h2>Predictive Model</h2>
    <p>
        Up to this point, we’ve shown that immune activity differs across severity groups and evolves over the course
        of infection. The next step is to test whether these patterns are predictive: can we use a patient’s immune
        profile (summarized by our immune scores), together with basic patient characteristics, to predict how severe
        their infection will become? We try the prediction task in two ways. First, we use the dataset’s original
        clinical labels and continuous time information, which reflects how disease progression is recorded in practice.
        Then, we repeat the same modeling using the grouped severity categories and time bins introduced earlier.
        This second setup matches the biological staging we use throughout the data story and helps reduce label noise.
    </p>

    <section id="model_performance" class="model-perf-section">
    <h2>Model performance</h2>
    <p>
        Figure 10 compares two models Random Forest (RF) and XGBoost (XGB) under both setups. The left panel shows
        Macro-F1 (a score that balances performance across classes, which matters when groups are imbalanced), and
        the right panel shows accuracy. What stands out is the shift from left to right: when we move from ungrouped
        labels / raw time to grouped severities / time bins, performance improves for both models, and especially for
        XGBoost. This suggests that the <span>grouped representation makes the learning problem cleaner:</span> severity stages
        become more consistent, and the model can focus on the signal rather than on ambiguous boundaries.
    </p>
    <div class="side-by-side-figures" style="margin: 50px 0 0 0">
        <div class="flourish-embed flourish-slope figure-flourish" data-src="visualisation/26885244"><script src="https://public.flourish.studio/resources/embed.js"></script><noscript><img src="https://public.flourish.studio/visualisation/26885244/thumbnail" width="100%" alt="slope visualization" /></noscript></div>
        <div class="flourish-embed flourish-slope figure-flourish" data-src="visualisation/26885113"><script src="https://public.flourish.studio/resources/embed.js"></script><noscript><img src="https://public.flourish.studio/visualisation/26885113/thumbnail" width="100%" alt="slope visualization" /></noscript></div>
    </div>

        <div class="figure-title" style="width: 800px">
            <h3>Fig. 10</h3>
            <p>Difference in performance of XGBoost and Random forest using grouped or ungrouped severities and time bins,
                measured in Accuracy vs Macro-F1</p>
        </div>

    </section>

    <section id="feature_importance" class="feature-imp-section">
    <h2>Feature importance</h2>
    <p>
        Predicting well is only part of the story, we also want to understand what the models are looking at. To do
        that, we examine feature importance and map it back to immune cell types. On the Sankey diagrams below,
        features start on the left as cell subtypes, flow into broader immune families (middle), and end at the
        model (right). The thickness of the flow reflects how much that feature contributes to the prediction.
    </p>
    <p>
        In Figure 11, feature importance is shown for the models trained on the original labels. <span>Both models point
        to biologically plausible immune compartments, but they do so in different ways.</span> Random Forest spreads its
        importance more broadly across several immune families, suggesting that it relies on a wider combination of
        signals. XGBoost, in contrast, concentrates importance into a smaller set of highly informative features, still
        within the same major immune families, indicating a more selective decision strategy.
    </p>

        <div class="side-by-side-figures" style="margin: 50px 0 0 0">
            <div class="flourish-embed flourish-sankey sankey-diagram" data-src="visualisation/26906116"><script src="https://public.flourish.studio/resources/embed.js"></script><noscript><img src="https://public.flourish.studio/visualisation/26906116/thumbnail" width="100%" alt="sankey visualization" /></noscript></div>
            <div class="flourish-embed flourish-sankey sankey-diagram" data-src="visualisation/26904223"><script src="https://public.flourish.studio/resources/embed.js"></script><noscript><img src="https://public.flourish.studio/visualisation/26904223/thumbnail" width="100%" alt="sankey visualization" /></noscript></div>
        </div>

        <div class="figure-title" style="margin-bottom: 30px">
            <h3>Fig. 11</h3>
            <p>Feature importance of immune cells according to RF and XGB models, using original labels.</p>
        </div>


        <p>
            In Figure 12, we repeat the same feature-importance view using the grouped severity and binned time setup.
            Here, the picture becomes clearer and more consistent across models: the most influential signals concentrate
            in a smaller set of immune families, with myeloid cells (dendritic cells / monocytes) standing out as central
            drivers. Adaptive immune compartments (especially CD4 T cells, followed by B & plasma cells) also remain
            prominent. Compared to the ungrouped setup, <span>importance is less scattered across many isolated subtypes and
            instead aligns more strongly with broader immune families,</span> which makes the story easier to interpret
            biologically.
        </p>

        <div class="side-by-side-figures" style="margin: 50px 0 0 0">
            <div class="flourish-embed flourish-sankey sankey-diagram" data-src="visualisation/26915340"><script src="https://public.flourish.studio/resources/embed.js"></script><noscript><img src="https://public.flourish.studio/visualisation/26915340/thumbnail" width="100%" alt="sankey visualization" /></noscript></div>
            <div class="flourish-embed flourish-sankey sankey-diagram" data-src="visualisation/26915544"><script src="https://public.flourish.studio/resources/embed.js"></script><noscript><img src="https://public.flourish.studio/visualisation/26915544/thumbnail" width="100%" alt="sankey visualization" /></noscript></div>
        </div>

        <div class="figure-title" style="margin-bottom: 30px">
            <h3>Fig. 12</h3>
            <p>Feature importance of immune cells according to RF and XGB models, using grouped labels.</p>
        </div>

        <p>
            We can now answer our third research question: <span>yes, immune profiles carry predictive signal for COVID-19
            severity.</span> Across models, the most informative features consistently come from a few key immune compartments,
            mainly myeloid cells (especially monocytes and dendritic cells) and T-cell populations, with B/plasma cells
            also contributing. In our final, grouped setup, prediction is driven primarily by these immune signatures,
            while the exact timing information plays a much smaller role. Overall, this suggests that severity is
            reflected less by a single “when” factor and more by which immune programs are activated in each patient.
        </p>
    </section>


</section>

<section id="conclusion" class="page-section">
    <h2>Conclusion</h2>
    <p>
        Across this project, we move from early marker-based intuition to systematic regression, then to immune scores,
        temporal trajectories, and finally prediction. The consistent theme is that COVID-19 severity is not explained
        by a single gene or a single immune cell type, but by a structured, cell-type dependent immune response that
        unfolds over time. Even with the limitations of non-longitudinal sampling, the fact that we can summarize immune
        activity into interpretable scores, observe severity-dependent trajectories, and use these signals to predict
        severity suggests that immune profiling can meaningfully inform how we understand and stratify COVID-19 outcomes.
        At the same time, our analysis also highlights what could be gained with more data. Because later stages of
        infection are sparsely sampled in this cohort, our time-binned trajectories remain limited by coverage. With
        a larger and more evenly sampled dataset, time bins could carry even more value: models could learn richer
        stage-specific immune signatures, better capture differences in timing and persistence, and potentially improve
        severity prediction, especially for separating closely related clinical groups.
    </p>
</section>

<div id="sidebar-question" class="sidebar-question">
    <h2 id="sidebar-question-title"></h2>
    <p id="sidebar-question-text"></p>
</div>

<footer class="site-footer">
    <div class="footer-content">
        <div class="footer-names">
            <span>Matis Ribadeau Dumas</span>
            <span>Teo Wermeille</span>
            <span>Toni Nigro</span>
            <span>Nestor Melissargos</span>
            <span>Matteo Jourdan</span>
        </div>
        <a href="https://github.com/matteojourdan/data-story-new" class="github-link" target="_blank" rel="noopener">
            <svg height="24" width="24" viewBox="0 0 16 16" fill="currentColor">
                <path d="M8 0C3.58 0 0 3.58 0 8c0 3.54 2.29 6.53 5.47 7.59.4.07.55-.17.55-.38 0-.19-.01-.82-.01-1.49-2.01.37-2.53-.49-2.69-.94-.09-.23-.48-.94-.82-1.13-.28-.15-.68-.52-.01-.53.63-.01 1.08.58 1.23.82.72 1.21 1.87.87 2.33.66.07-.52.28-.87.51-1.07-1.78-.2-3.64-.89-3.64-3.95 0-.87.31-1.59.82-2.15-.08-.2-.36-1.02.08-2.12 0 0 .67-.21 2.2.82.64-.18 1.32-.27 2-.27.68 0 1.36.09 2 .27 1.53-1.04 2.2-.82 2.2-.82.44 1.1.16 1.92.08 2.12.51.56.82 1.27.82 2.15 0 3.07-1.87 3.75-3.65 3.95.29.25.54.73.54 1.48 0 1.07-.01 1.93-.01 2.2 0 .21.15.46.55.38A8.013 8.013 0 0016 8c0-4.42-3.58-8-8-8z"/>
            </svg>
            View on GitHub
        </a>
    </div>
</footer>


<script src="{{ '/assets/js/scroll-animations.js' | relative_url }}"></script>
<script src="{{ '/assets/js/active_nav.js' | relative_url }}"></script>
<script src="{{ '/assets/js/temp_ana_selector.js' | relative_url }}"></script>

<!-- D3 -->
<script src="{{ 'https://d3js.org/d3.v7.min.js'}}"></script>

<!-- Vega-Lite for markers visualization -->
<script src="{{ 'https://cdn.jsdelivr.net/npm/vega@5'}}"></script>
<script src="{{ 'https://cdn.jsdelivr.net/npm/vega-lite@5' }}"></script>
<script src="{{ 'https://cdn.jsdelivr.net/npm/vega-embed@6' }}"></script>

<!-- Your radar plot logic -->
<script src="{{ '/assets/js/onset_hist.js' | relative_url }}"></script>

<!-- Markers visualization -->
<link rel="stylesheet" href="{{ '/assets/css/markers.css' | relative_url }}">
<script src="{{ '/assets/js/markers.js' | relative_url }}"></script>

<!-- Raw/Log histogram -->
<link rel="stylesheet" href="{{ '/assets/css/raw_log.css' | relative_url }}">
<script src="{{ '/assets/js/raw_log.js' | relative_url }}"></script>

<!-- Immune trajectory visualization -->
<link rel="stylesheet" href="{{ '/assets/css/imm_traj.css' | relative_url }}">
<script src="{{ '/assets/js/imm_traj.js' | relative_url }}"></script>
