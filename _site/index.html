<!doctype html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>Home</title>
    <link rel="stylesheet" href="/assets/css/styles.css?v=">
    <link rel="stylesheet" href="/assets/css/onset_hist.css?v=">
    <link rel="icon" href="assets/img/coronavirus.png" type="image/png">
</head>
<!-- Sticky Navbar -->
<nav class="navbar">
    <div class="navbar-container">
        <!-- Left: Data Story -->
        <div class="navbar-left">
            <a href="/" class="navbar-title">Data story</a>
        </div>

        <!-- Center: Section Links (e.g., Introduction) -->
        <ul class="navbar-links-center">
            
            
            <li class="navbar-link-item dropdown">
                    
                        <a href="#introduction" class="navbar-link">Introduction</a>
                    
                    <div class="dropdown-content">
                        
                            
                                <a href="#research_questions">Research questions</a>
                            
                        
                            
                                <a href="#data_exploration">Data Exploration</a>
                            
                        
                    </div>
                </li>
                
                
            
                <li class="navbar-link-item">
                    
                        <a href="#diff_ana" class="navbar-link">Differential Analysis</a>
                    
                </li>
                
                
            
                <li class="navbar-link-item">
                    
                        <a href="#temp_ana" class="navbar-link">Temporal Analysis</a>
                    
                </li>
                
                
            
            <li class="navbar-link-item dropdown">
                    
                        <a href="#pred_mod" class="navbar-link">Predictive Model</a>
                    
                    <div class="dropdown-content">
                        
                            
                                <a href="#model_performance">Model Performance</a>
                            
                        
                            
                                <a href="#feature_importance">Feature Importance</a>
                            
                        
                    </div>
                </li>
                
                
            
                
            
                
            </ul>

            <!-- Right: Other Links (e.g., Gallery) -->
        <ul class="navbar-links">
            
            
            
            
            
            
            
            
            
            
            <li class="navbar-link-item">
                <a href="/gallery" class="navbar-link">
                    Gallery
                </a>
            </li>
            
            
            
            <li class="navbar-link-item">
                <a href="/data" class="navbar-link">
                    Data
                </a>
            </li>
            
            
        </ul>
    </div>
</nav>
<body>
<div class="fullscreen-header">
    <header class="fullscreen-header">
        <h1 class="header-title">Mapping the Immune Response across Time and Severities in COVID-19 Patients</h1>
    </header>

    <p><img class="header-image" src="/assets/img/cool_cell.jpg" alt="cool cell"></p>
</div>

<section id="introduction" class="introduction-section">
    <img class="intro-paper-snippet" src="/assets/img/paper_snippet.png" alt="paper snippet">
    <h2>Introduction</h2>
    <p>Understanding why COVID-19 affects patients so differently, and the immunological differences explaining it,
        is crucial for developing effective, personalized treatments.
        To investigate these differences, we analyze a comprehensive single-cell multi-omics dataset profiling more
        than 780,000 immune cells from 130 patients spanning the full spectrum of COVID-19 severity. From this dataset
        we analyze how immune cell populations vary, along with their gene expression levels,
        and how these changes relate to the progression and intensity of the infection.
        Our final goal is to create a predictive model that can use a patient's immune profile, combined with their
        intrinsic data (age, sex, lifestyle factors), to predict an individual’s vulnerability to severe
        COVID-19 and tailor their treatment.</p>
    <p>This website walks you through our data analysis, from cleaning and
        visualizing the data, to identifying and scoring mechanisms linked with disease severity, to finally training
        a predictive model with what we found.</p>
</section>

<section id="research_questions" class="research-section">
    <h2>Research questions</h2>
    <div class="research-questions-container">
        <div class="research-question left">
            <span class="question-number">1.</span>
            <p>Can we identify and score key genes and cells participating in the immune response to COVID-19?</p>
        </div>
        <div class="research-question right">
            <span class="question-number">2.</span>
            <p>Can we reconstruct the timeline and trajectory of a patient’s COVID-19 infection?</p>
        </div>
        <div class="research-question left">
            <span class="question-number">3.</span>
            <p>Can a patient’s immune profile combined with their intrinsic characteristics (sex, age, smoking habits, ...) be used to predict the severity of their infection?</p>
        </div>
    </div>
</section>

<!-- Gallery Section -->

<section id="data_exploration" class="data-section">
    <h2>Data Exploration</h2>
    <div class="data-column">
        <p>The first step we took in our analysis was to understand who the patients
            in the dataset are. To get a broad view of the cohort, we explored the
            <span>patients’ clinical metadata</span> such as age, sex, and sample collection site.
            This initial overview revealed important information in how patients were distributed
            across these categories. For example, male and female patients were nearly
            equally represented, while age, smoking status, and sample collection site were notably
            imbalanced. In particular, samples from older, non-smoking adults at the Ncl collection
            site made up a large portion of the dataset. This distribution is shown Fig. 1 on the right.

            <br/>
            We then focused our attention on <span>severity and days from onset</span>, as these were
            key variables for our
            project. By visualizing different combinations of these features and how they relate
            to patient characteristics, we gained an initial qualitative sense of the dataset’s structure
            and dynamics.
            However, we found that most patients were captured within the first
            two weeks of illness and belonged to the Mild and Moderate severity groups. This revealed
            clear imbalances in the number of patients across severity
            groups as well as uneven sampling across the days from symptom onset. To address this and
            ensure meaningful and comparable downstream analysis, we applied preprocessing
            steps aimed at balancing these distributions. The second figure on the right illustrates the
            resulting dataset structure, showing how samples are distributed across the severity groups
            and within our chosen symptom-onset time bins.</p>

        <div class="data-exploration-image">
            <section id="onset">
                <!-- Controls -->
                <div id="controls" class="#controls">
                    <label for="severitySelect" class="label">Severity:</label>
                    <select id="severitySelect" class="select"></select>
                </div>

                <!-- Optional legend (JS expects it) -->
                <div id="legend" class="#legend"></div>

                <!-- Chart container (REQUIRED) -->
                <div id="chart" class="#chart"></div>

                <!-- Tooltip -->
                <div id="tooltip" class="tooltip"></div>

                <div class="figure-title">
                    <h3>Fig. 1</h3>
                    <p>Distribution of patients in days from onset, across severities</p>
                </div>

            </section>
        </div>
    </div>
    <div class="data-column">
        <div class="data-double-image">
            <div class="data-exploration-figure">
                <img class="data-exploration-image"
                 src="/assets/img/expr_levels_ISG.png"
                 alt="ISG expression levels"/>

                <div class="figure-title">
                    <h3>Fig. 2</h3>
                    <p>ISG expression across immune families and severity groups</p>
                </div>
            </div>
            <section id="markers">
                <!-- Controls -->
                <div class="controls">
                    <div class="checkbox-row">
                        <label for="geneDropdown">Gene:</label>
                        <select id="geneDropdown" class="select"></select>
                    </div>

                    <div class="checkbox-row">
                        <label for="showOutlierToggle">Show Outlier:</label>
                        <input type="checkbox" id="showOutlierToggle">
                    </div>
                </div>

                <div class="radio-buttons">

                    <label>Display Mode:</label>
                    <div class="radio-choices-tight">
                        <div class="radio-row">
                            <input type="radio" name="lineMode" value="mean" checked>
                            <label>Mean</label>
                        </div>
                        <div class="radio-row">
                            <input type="radio" name="lineMode" value="regression">
                            <label>Regression</label>
                        </div>
                        <div class="radio-row">
                            <input type="radio" name="lineMode" value="both">
                            <label>Both</label>
                        </div>
                    </div>
                </div>
                
                <!-- Visualization container -->
                <div id="vis"></div>
                
                <div class="figure-title">
                    <h3>Fig. 3</h3>
                    <p>Temporal trajectories of interferon-stimulated genes, toggle for outlier</p>
                </div>
            </section>
        </div>

        <p>After exploring the patients' metadata, we wanted to familiarize ourselves with the <span>gene
        expression levels of different immune cell types, in time.</span> To do so, we hand-picked
        single genes known to play key roles in antiviral and inflammatory responses, namely ISG15,
        IFITM3, MX1, and other ISGs. Their expression levels
        were then plotted across major immune families and across severities, as shown by the first plot
        on the left. This visualization confirmed that Worst_Clinical_Status was a more
        meaningful severity variable than Status_on_day_collection.
        These trends also gave us a sense of which immune families show the strongest
        severity-linked responses, guiding the choices we made later when selecting cell types
        and genes for our downstream immune activation analyses. <br/>
        Lastly, we wanted to examine the <span>temporal trajectories</span> of these interferon-stimulated
        genes using our predefined time bins. We can see in the second plot on the left that these
        markers exhibit clear temporal dynamics that differ across severities. This hints towards
        the potential for interesting results from our downstream analyses of COVID-19 infection trajectories. 
        It also allowed us to identify an important outlier which can be displayed using the toggle on figure 3.</p>

    </div>
</section>

<section id="diff_ana" class="page-section">
    <h2>Differential Analysis</h2>
    <p>
By examining the dataset, we noticed it contained negative values, which confirmed the data had been scaled.
Because differential expression analysis requires untransformed UMI counts,
these processed values are not appropriate. However, as seen in figure 4 (data from cd4.prolif of a few patients),
the raw data still needs to be transformed. We chose a log1p transform which can be displayed using the toggle.
This helps to stabilize variance and make the data more interpretable for differential expression analysis.
We use differential analysis to identify the genes whose expression increases or decreases with disease severity. 
Our approach is to use a linear regression model for each gene’s expression across cells and patients.
We chose to do a pseudo-bulk analysis, aggregating gene expression at the patient level by summing counts across cells within specific immune cell families.
By reducing the data to a patient-level summary, we can perform the analysis more efficiently, 
while still capturing the key variability in gene expression related to disease severity. The results are displayed in the packed circles graph,
 with size being defined by the metric returned by the differential expression analysis.
    </p>
    
    <div class="data-exploration-image">
        <div id="raw-log-chart"></div>
        <div class="figure-title">
            <h3>Fig. 4</h3>
            <p>Distribution of scaled and raw UMI counts</p>
        </div>
    </div>

    <div class="packed-circles">
        <div class="flourish-embed flourish-hierarchy packed-circles" data-src="visualisation/26892943"><script src="https://public.flourish.studio/resources/embed.js"></script><noscript><img src="https://public.flourish.studio/visualisation/26892943/thumbnail" width="100%" alt="hierarchy visualization" /></noscript></div>
        <div class="figure-title">
            <h3>Fig. 5</h3>
            <p>Coefficients of the 50 most differentially expressed genes in their respective cells</p>
        </div>
    </div>

</section>

<section id="temp_ana" class="page-section">
    <h2>Temporal Analysis</h2>
    <p>Lorem ipsum dolor sit amet consectetur adipiscing elit. Quisque faucibus ex sapien vitae pellentesque sem placerat. In id cursus mi pretium tellus duis convallis. Tempus leo eu aenean sed diam urna tempor. Pulvinar vivamus fringilla lacus nec metus bibendum egestas. Iaculis massa nisl malesuada lacinia integer nunc posuere. Ut hendrerit semper vel class aptent taciti sociosqu. Ad litora torquent per conubia nostra inceptos himenaeos.

        Lorem ipsum dolor sit amet consectetur adipiscing elit. Quisque faucibus ex sapien vitae pellentesque sem placerat. In id cursus mi pretium tellus duis convallis. Tempus leo eu aenean sed diam urna tempor. Pulvinar vivamus fringilla lacus nec metus bibendum egestas. Iaculis massa nisl malesuada lacinia integer nunc posuere. Ut hendrerit semper vel class aptent taciti sociosqu. Ad litora torquent per conubia nostra inceptos himenaeos.

        Lorem ipsum dolor sit amet consectetur adipiscing elit. Quisque faucibus ex sapien vitae pellentesque sem placerat. In id cursus mi pretium tellus duis convallis. Tempus leo eu aenean sed diam urna tempor. Pulvinar vivamus fringilla lacus nec metus bibendum egestas. Iaculis massa nisl malesuada lacinia integer nunc posuere. Ut hendrerit semper vel class aptent taciti sociosqu. Ad litora torquent per conubia nostra inceptos himenaeos.

    </p>

    <div class="imm-traj-container">
        <div class="controls">
            <label for="imm-traj-dropdown">Cell Type:</label>
            <select id="imm-traj-dropdown"></select>
        </div>
        <div id="imm-traj-vis"></div>
        <div class="figure-title">
            <h3>Fig. 6:</h3>
            <p>Cell-type scores across time bins and severity groups</p>
        </div>
    </div>
</section>

<section id="pred_mod" class="page-section">
    <h2>Predictive Model</h2>
    <p>To predict how severe a patient’s COVID-19 infection will become, we developed a model that combines clinical
        information with immune system signals. The clinical information includes factors such as age, sex, smoking
        status, and time since symptom onset. The immune profile is summarized by the cell-level scores computed earlier,
        which capture immune activation based on the expression of key genes associated with COVID-19 severity. By
        bringing these two sources of information together, <span>the model aims to anticipate the overall trajectory of the
        disease for each patient.</span>
    </p>

<section id="model_performance" class="model-perf-section">
    <h2>Model performance</h2>
    <p>We approached this prediction task in two complementary ways. First, we used the dataset’s original severity
        labels and continuous days-from-onset measurements, reflecting how disease progression is recorded in real-world
        clinical settings. We then repeated the analysis using the grouped severity categories and discretized time bins
        introduced in our Data Exploration. This second approach allowed us to assess whether a simpler, biologically
        motivated representation of the data leads to better interpretability and stronger predictions. <br/>
        Across both settings, <span>we compared different machine-learning models</span> to evaluate how accurately they could
        predict disease severity. Figure 5 below summarizes model performance using accuracy and F1-score.
        Overall, the grouped-severity and time-binned representation leads to a clear improvement for both models,
        with especially strong gains for XGBoost. This suggests that organizing clinical outcomes into biologically
        coherent categories and disease stages reduces noise and ambiguity in the labels, making severity easier to
        predict. Under this formulation, XGBoost performs best overall, indicating that meaningful predictions of
        COVID-19 severity can be made using this model.
    </p>
    <div class="side-by-side-figures">
        <div class="flourish-embed flourish-slope figure-flourish" data-src="visualisation/26885244"><script src="https://public.flourish.studio/resources/embed.js"></script><noscript><img src="https://public.flourish.studio/visualisation/26885244/thumbnail" width="100%" alt="slope visualization" /></noscript></div>
        <div class="flourish-embed flourish-slope figure-flourish" data-src="visualisation/26885113"><script src="https://public.flourish.studio/resources/embed.js"></script><noscript><img src="https://public.flourish.studio/visualisation/26885113/thumbnail" width="100%" alt="slope visualization" /></noscript></div>
    </div>

        <div class="figure-title" style="width: 800px">
            <h3>Fig. 5</h3>
            <p>Difference in performance of XGBoost and Random forest using grouped or ungrouped severities and time bins,
                measured in Accuracy vs Macro-F1</p>
        </div>

    </section>

<section id="feature_importance" class="feature-imp-section">
    <h2>Feature importance</h2>
    <p>Beyond asking how well our models predict COVID-19 severity, we wanted to understand what specific features drive
        these predictions. <span>To do this, we examined feature importance patterns from our models, which highlight the
        immune cells that most strongly influence the predictions.</span> To properly analyze feature importance, we looked at it through two axes. First, we visualized how our two algorithms
        prioritize immune signals, and what differences there are between them.
        Our second axis aimed to compare the feature rankings obtained when using the dataset's original labels against those found using
        our grouped severities and time representations. This allowed us to see how simplifying the clinical labels affects
        which features emerge as important. <br/>
        Features that remain influential across both models likely represent robust biological signals linked to COVID-19 severity,
        and could be prioritized for further study.
    </p>
    <p>
        Starting with the ungrouped severity and time labels, we found that both models highlighted biologically
        meaningful immune pathways linked to COVID-19 severity, although they disagreed on the ordering of these features.
        The Random Forest model (on the right below) spread importance across
        multiple related immune cell types, namely CD4 and CD8 T cells, dendritic cells and monocytes, suggesting
        that severity is associated with coordinated changes across several immune
        compartments rather than a single dominant signal.
        In contrast, XGBoost (on the left below) focused on a smaller set of highly informative features within these same immune families.
        Myeloid cells and CD4 T cells emerged as especially influential, reflecting more targeted immune signatures that
        best distinguish severe from mild disease.
        Across both models, platelet-related and progenitor cell signals (not shown) played only a minor role, suggesting limited
        relevance for severity prediction in this setting. These observations are summarized in Figure 6 below.
    </p>

        <div class="side-by-side-figures">
            <div class="flourish-embed flourish-sankey sankey-diagram" data-src="visualisation/26906116"><script src="https://public.flourish.studio/resources/embed.js"></script><noscript><img src="https://public.flourish.studio/visualisation/26906116/thumbnail" width="100%" alt="sankey visualization" /></noscript></div>
            <div class="flourish-embed flourish-sankey sankey-diagram" data-src="visualisation/26904223"><script src="https://public.flourish.studio/resources/embed.js"></script><noscript><img src="https://public.flourish.studio/visualisation/26904223/thumbnail" width="100%" alt="sankey visualization" /></noscript></div>
        </div>

        <div class="figure-title">
            <h3>Fig. 6</h3>
            <p>Feature importance of immune cells according to RF and XGB models, using original labels.</p>
        </div>


        <p>
            We then shifted to grouped severity categories and time bins, under which the immune features
            driving predictions became clearer and more consistent across models. In this setting, both models
            agreed that myeloid cells, especially dendritic cells and monocytes, were
            central to disease severity. This highlights the key role of innate immune dysregulation and antigen
            presentation in shaping overall COVID-19 outcomes.
            The adaptive immune system also remained prominent, as CD4 T cells ranked among the most
            important contributors, followed by B and plasma cells, showing the importance of adaptive
            immune responses in severe disease.
            Compared to the ungrouped analysis, importance was no longer spread across many isolated cell subtypes but rather
            at the level of broader cell families. This suggests that the grouped
            representation captures the bigger picture and identifies the core immune mechanisms underlying disease progresion.
            While the two models
            still differed slightly in how they distributed importance, they now agreed on the same overall hierarchy of
            immune families. This is shown in Figure 7.
        </p>
    </section>


</section>

<div id="sidebar-question" class="sidebar-question">
    <h2 id="sidebar-question-title"></h2>
    <p id="sidebar-question-text"></p>
</div>

<script src="/assets/js/scroll-animations.js"></script>

<!-- D3 -->
<script src="https://d3js.org/d3.v7.min.js"></script>

<!-- Vega-Lite for markers visualization -->
<script src="https://cdn.jsdelivr.net/npm/vega@5"></script>
<script src="https://cdn.jsdelivr.net/npm/vega-lite@5"></script>
<script src="https://cdn.jsdelivr.net/npm/vega-embed@6"></script>

<!-- Your radar plot logic -->
<script src="/assets/js/onset_hist.js"></script>

<!-- Markers visualization -->
<link rel="stylesheet" href="/assets/css/markers.css">
<script src="/assets/js/markers.js"></script>

<!-- Raw/Log histogram -->
<link rel="stylesheet" href="/assets/css/raw_log.css">
<script src="/assets/js/raw_log.js"></script>

<!-- Immune trajectory visualization -->
<link rel="stylesheet" href="/assets/css/imm_traj.css">
<script src="/assets/js/imm_traj.js"></script>

</body>
</html>
